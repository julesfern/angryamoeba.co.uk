<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
 
 <title>Singlecell, the Angry amoeba weblog</title>
 <link href="http://www.angryamoeba.co.uk/singlecell/atom.xml" rel="self"/>
 <link href="http://www.angryamoeba.co.uk/singlecell/"/>
 <updated>2009-02-21T17:16:39+00:00</updated>
 <id>http://www.angryamoeba.co.uk/singlecell</id>
 <author>
   <name>Dan Glegg</name>
   <email>dan@angryamoeba.co.uk</email>
 </author>
 
 
 <entry>
   <title>The Hacker's Amendment</title>
   <link href="http://www.angryamoeba.co.uk/singlecell/2009/02/17/The-Hacker-s-Amendment.html"/>
   <updated>2009-02-17T00:00:00+00:00</updated>
   <id>http://www.angryamoeba.co.uk/singlecell/2009/02/17/The-Hacker-s-Amendment</id>
   <content type="html"> 

&lt;a href="http://slashdot.org/~Artraze"&gt;Artraze&lt;/a&gt;, a commenter on Slashdot, discussing &lt;a href="http://tech.slashdot.org/article.pl?sid=09/02/16/2259257"&gt;the possibility of sinister DRM in Windows 7&lt;/a&gt;

&lt;blockquote&gt;&lt;p&gt;Congress shall pass no law limiting the rights of persons to manipulate, operate, or otherwise utilize as they see fit any of their possessions or effects, nor the sale or trade of tools to be used for such purposes.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;What can I say, apart from a strong, resounding &lt;strong&gt;yes&lt;/strong&gt;?&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>The API antipattern, Twitter, and the Fail Whale's new clothes</title>
   <link href="http://www.angryamoeba.co.uk/singlecell/2008/11/28/The-API-antipattern-Twitter-and-the-Fail-Whale-s-new-clothes.html"/>
   <updated>2008-11-28T00:00:00+00:00</updated>
   <id>http://www.angryamoeba.co.uk/singlecell/2008/11/28/The-API-antipattern-Twitter-and-the-Fail-Whale-s-new-clothes</id>
   <content type="html"> 

&lt;p&gt;Not enough developers get angry when they encounter the &lt;a href="http://adactio.com/journal/1357"&gt;password antipattern&lt;/a&gt;. You’ll know it when you see it because you’ll see &lt;strong&gt;site A&lt;/strong&gt; asking you for your login credentials for &lt;strong&gt;site B&lt;/strong&gt; in order to enable &lt;strong&gt;cool feature C&lt;/strong&gt;. That &lt;strong&gt;cool feature C&lt;/strong&gt; is &lt;em&gt;usually&lt;/em&gt; a mechanic for spamming &lt;strong&gt;site A&lt;/strong&gt;’s users into signing up for &lt;strong&gt;site B&lt;/strong&gt; notwithstanding, this pattern smells worse than week-old crab left wrapped up in some wet newspaper atop a radiator.&lt;/p&gt;

&lt;p&gt;Yes. This pattern is terrible for security because the least secure part of any system is inevitably the fallible bipedal meat-creature who uses that system, and a culture that encourages meat-beings to hand over login credentials to any form that winks and offers to buy us a drink will only further damage our already poor &lt;a href="http://en.wikipedia.org/wiki/Series_of_tubes"&gt;intertube&lt;/a&gt; survival instincts. Not only is this insecure, but a complete replacement of the concept of &lt;em&gt;authentication&lt;/em&gt; by a dangerously brittle system of electronic hearsay.&lt;/p&gt;

&lt;h4 id="when_you_say_auth_do_you_mean_authentication_or_authorisation"&gt;When you say auth, do you mean authentication or authorisation?&lt;/h4&gt;

&lt;p&gt;Let’s go back to basics for a second. What does “authentication” mean? A brief fumble with &lt;a href="http://www.google.co.uk/search?hl=en&amp;amp;q=define%3Aauthentication&amp;amp;btnG=Search"&gt;google’s define function&lt;/a&gt; yields the following:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;[Authentication is] The process of identifying an individual or data. In security systems, authentication is distinct from authorization. Authentication merely confirms that the identification of the individual or data is accurate.
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;And quite right, too. When your small personal army of Twitter client apps* are out there, running in the cloud, firing periodic requests off to Twitter, they’re authenticating as yourself. Twitter has no way to discern whether those requests come from you, or any one of the many agents you authorise to access your account. Put the other way, all agents accessing your account have the full power of the account owner, including the ability to change your password and lock you out of your account. Let’s not even get into the miniature localised apocalypse you’ll trigger whenever you change your password yourself.&lt;/p&gt;

&lt;p&gt;Nowhere else, in any sphere of security, is this considered acceptable. Take as an example the entourage who orbit closely around a given celebrity (that’s you, you lucky thing). Your entourage look after you, they have access to your stuff, but they don’t carry your passport and driver’s license. They carry their &lt;em&gt;own identification which institutions accept as authorisation to access your stuff&lt;/em&gt;. That’s the right way to do it. Your fabulous slick-haired fashion consultant - his name is Quantum, by the way, not that you care - &lt;em&gt;authenticates&lt;/em&gt; as himself when he calls up the designers, but the designers know that he is &lt;em&gt;authorised&lt;/em&gt; to buy clothes for you, because you’re too busy recording a voiceover for a rigidly formulaic CG animal cuddlefest about a penguin called Zappy who gets lost in New York with the baby of a wealthy but comedically inept couple.&lt;/p&gt;

&lt;p&gt;Anyway. The point is that the various software agents you give access to your account should have their own credentials with which they can access your account. The service they’re working with should recognise those credentials as having access to your account. An agent should never be able to change your password or perform other tasks that are reserved for you and you alone. You should be able to revoke those credentials if you lose trust in one of your agents. You should be able to grant time-limited or once-only to agents you’re just trying out.&lt;/p&gt;

&lt;p&gt;There’s one site in particular who &lt;em&gt;already have this solved&lt;/em&gt;. It’s &lt;a href="http://flickr.com"&gt;Flickr&lt;/a&gt;. They nailed it pretty much from the get-go. Just look at the &lt;a href="http://www.flickr.com/services/api/auth.spec.html"&gt;documentation&lt;/a&gt; for authenticating with them. It’s beautiful, and the fact that no major independent player has been visibly inspired by it is, frankly, shocking.&lt;/p&gt;

&lt;p&gt;The vast majority of Twitter’s traffic is via their API. And they’re still running on basic HTTP authentication, the way neanderthals authenticated with &lt;em&gt;their&lt;/em&gt; social microstatus aggregators. It’s time for them to do better, like we all know they can.&lt;/p&gt;

&lt;p&gt;*For Twitter, being particularly complicit in this problem, shall have the pleasure of being my whipping boy for the purposes of this article.&lt;/p&gt;

&lt;p&gt;Addendum: And see below. Twitter comments - I loved the idea of them. But people need to enter their password in order to comment. Twitter&amp;#8217;s bizarrely primitive approach to authentication is a massive barrier to innovation in this way.&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>An introduction to merb-auth and the wonderful secrets contained within</title>
   <link href="http://www.angryamoeba.co.uk/singlecell/2008/11/22/An-introduction-to-merb-auth-and-the-wonderful-secrets-contained-within.html"/>
   <updated>2008-11-22T00:00:00+00:00</updated>
   <id>http://www.angryamoeba.co.uk/singlecell/2008/11/22/An-introduction-to-merb-auth-and-the-wonderful-secrets-contained-within</id>
   <content type="html"> 

&lt;p&gt;The point of a framework is to help automate common work, right? So why is building your application’s authentication system so repetetive? The &lt;a href="http://merbivore.com/"&gt;Merb&lt;/a&gt; framework does a lot of useful things and, thankfully, finally includes core patterns and support for user authentication within the framework. It’s called merb-auth, it just moved into town, and it is already beating up other frameworks and stealing their lunch money. And dating your daughter.&lt;/p&gt;

&lt;p&gt;You should use merb-auth because:
&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;It provides a clean, easily-extendable structure for authentication.&lt;/li&gt;
&lt;li&gt;It’s part of the official framework, so it’s far less likely to break between versions.&lt;/li&gt;
&lt;li&gt;It’s just plain damned sensible when you weigh up what it automates for you.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;So let’s build a quick merb app to test it with:&lt;/p&gt;

&lt;pre&gt;&lt;code class="bash"&gt;merb-gen app merb-auth-playground
cd merb-auth-playground
merb-gen resource secret
merb-gen resource user&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id="starting_at_the_beginning_merb_auth_core"&gt;Starting at the beginning: merb-auth-core&lt;/h3&gt;

&lt;pre&gt;&lt;code class="ruby"&gt;# Add this to config/dependencies.rb if not already present
dependency "merb-auth-core"&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;What happened? Nothing you can see just yet. This is because, as with all merb components that offer a “core” package, the core contains only structure upon which to hang your own code. merb-auth-core doesn’t care about or do anything to your app. It just provides some hooks for you to start using. What merb-auth-core &lt;em&gt;actually&lt;/em&gt; gives us is:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;Nifty support for storing authentication details in the user’s session:&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code class="ruby"&gt;# In any of your controllers
if session.user
    "You're logged in as user ID #{session.user.id}"
else
    "You're logged out, so you don't get an ID. You don't deserve one."
end&lt;/code&gt;&lt;/pre&gt;

&lt;ul&gt;
&lt;li&gt;Support for &lt;strong&gt;strategies&lt;/strong&gt;. Strategies are ways to authenticate a user. A username and password sent from a form is one strategy. OpenID is another, OAuth yet another. You can &lt;em&gt;register&lt;/em&gt; your own strategies with merb-auth, and &lt;em&gt;activate&lt;/em&gt; them when you want them used. When merb-auth tries to authenticate the user, it will call a method named &lt;em&gt;run!&lt;/em&gt; on each strategy in turn until one returns a user or it runs out of strategies. If a user is returned, then the authentication is successful. If not, then the authentication was unsuccessful and an exception will be raised.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Strategies look like this:&lt;/p&gt;

&lt;pre&gt;&lt;code class="ruby"&gt;# This is an example strategy
class Merb::Authentication
  module Strategies
      class MyCustomStrategy

        def run!
          do_something_that_returns_either_a_user_or_nil_or_false
        end 

        def strategy_error_message
          "AND THEN THERE WAS FAIL"
        end

      end
  end
end&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;You can register and activate them like this:&lt;/p&gt;

&lt;pre&gt;&lt;code class="ruby"&gt;# In config/init.rb:
Merb::Bootloader.after_app_loads do
    Merb::Authentication.register :custom_strategy, Merb.root / "path/to/your/strategy.rb"
  Merb::Authentication.activate! :custom_strategy
end&lt;/code&gt;&lt;/pre&gt;

&lt;ul&gt;
&lt;li&gt;An &lt;em&gt;ensure_authenticated&lt;/em&gt; method we can use in our controllers.&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code class="ruby"&gt;class Secrets &amp;lt; Merb::Controller
    before :ensure_authenticated

    def index
        "lol, juicy secrets"
    end     
end&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;There’s also one very important thing that merb-auth &lt;strong&gt;does not&lt;/strong&gt; give you. Merb-auth is &lt;strong&gt;Bring Your Own Model&lt;/strong&gt; code, which means you’re expected to write your own user model. If your user class is called User, which it probably is, then merb-auth will find it just fine with zero configuration. If your user class is called something else, then you’re a masochist, and you should add this to your init.rb:&lt;/p&gt;

&lt;pre&gt;&lt;code class="ruby"&gt;# config/init.rb:
Merb::BootLoader.after_app_loads do
  Merb::Authentication.user_class = MyCustomUserClass



end&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id="going_deeper_merb_auth_more"&gt;Going deeper: merb-auth-more&lt;/h3&gt;

&lt;p&gt;Adding merb-auth-core to our app got us all this sweet structure and architecture for free - we can trade authentication strategies with other developers, pretty much any merb developer we hire can understand our authentication system and we still get to define business logic ourselves. But what if we want to use merb-auth-core to do something totally basic that every developer has to build at least over 9000 times in their lifetime, like basic password auth? Enter &lt;strong&gt;merb-auth-more&lt;/strong&gt;. Merb-auth-more doesn’t contain any new architecture over and above merb-auth-core, but it what it does include is a package of ready-made auth strategies that work wonderfully right out the box. Let’s use merb-auth-more to add simple login form support to our application:&lt;/p&gt;

&lt;pre&gt;&lt;code class="ruby"&gt;# Add this to config/dependencies.rb if not already present
dependency "merb-auth-more"&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;And if we didn’t already, let’s craft a really simple user model including merb-auth-more’s salted, hashed password module.&lt;/p&gt;

&lt;pre&gt;&lt;code class="bash"&gt;merb-gen resource user&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class="ruby"&gt;# In app/models/user.rb
require 'merb-auth-more/mixins/salted_user'
class User
    include DataMapper::Resource
    include Merb::Authentication::Mixins::SaltedUser

    property :id, Serial
    property :email, String, :format=&amp;gt;:email_address
    property :login, String, :nullable=&amp;gt;false

    # You do not have to define password or password_confirmation attributes - the SaltedUser mixin does this for you.
    # You do not have to define the ::authenticate! method - SaltedUser does this for you.      

end&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;If you don’t want to use :login and :password as the params for logging in, or you want users to login using another property, you can easily customise this behaviour with this code:&lt;/p&gt;

&lt;pre&gt;&lt;code class="ruby"&gt;# config/init.rb:
Merb::BootLoader.after_app_loads do
  Merb::Plugins.config[:"merb-auth"][:login_param] = :email
    Merb::Plugins.config[:"merb-auth"][:password_param] = :secret_squirrel_decoder_ring
end&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Woot! Full authentication from controller to model is ours to use, enjoy and love, with little to no maintenance or hassle. But we don’t have any views set up to allow users to log in, which is somewhat problematic. But don’t panic, honey. Merb’s got your back.&lt;/p&gt;

&lt;h3 id="hot_damn_merb_auth_slice_password"&gt;Hot damn: merb-auth-slice-password&lt;/h3&gt;

&lt;p&gt;Merb-slices are awesome. They’re little apps designed to run inside your main apps - they can have their own controllers, models, helpers and views, which your main application can override on a file-by-file basis. They’re plugins on steroids - essentially the best way to refactor and share complex behaviour from one merb app to another. &lt;strong&gt;Merb-auth-slice-password&lt;/strong&gt; is a merb slice built on top of merb-auth-core and -more which uses merb-auth-more’s auth strategies to provide a simple login/logout mechanism for your app. Let’s get it running:&lt;/p&gt;

&lt;pre&gt;&lt;code class="ruby"&gt;# Add this to config/dependencies.rb if not already present
dependency "merb-auth-slice-password"&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class="ruby"&gt;# In your config/router.rb
# This will 'mount' the slice within your app's URL structure. 
# The :path_prefix option tells the router not to mount the slice at a subfolder like /merb-auth-slice-password/login.
# below: Merb::Router.prepare do
add_slice(:MerbAuthSlicePassword, :path_prefix =&amp;gt; nil)
# above: end&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class="bash"&gt;rake slices:merb-auth-slice-password:install
rake db:automigrate&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Let’s try booting up the app! Use the merb command to fire it up and check it out in a web browser. Hit http://localhost:4000 and you should see the merb welcome screen:&lt;/p&gt;

&lt;p&gt;&lt;img alt="Merb welcome screen" src="http://img.skitch.com/20081121-g36hbtg8e4hn4jxbyffgg6xyxf.jpg"/&gt;&lt;/p&gt;

&lt;p&gt;However, hit the protected controller we made at http://localhost:4000/secrets and hot diggity damn, free login functionality!&lt;/p&gt;

&lt;p&gt;&lt;img alt="Hot damn" src="http://img.skitch.com/20081121-gc9hd428jk9x4qf6dhqu7fncfd.jpg"/&gt;&lt;/p&gt;

&lt;p&gt;Now the login you have here follows a pattern called &lt;em&gt;exceptional authentication&lt;/em&gt;. Merb-auth considers you being logged out (when you need to be logged in) to be an exception, just like NotFound or any other exception. So instead of needing to bounce users to Sessions#new when the user visits a protected URL, we raise an exception and display the login page right there. A single specific URL with a :return_to param is still used to start the session as merb URLs can perform differently depending on the request method used, and we most likely want to render the GET version of the URL upon successful login.&lt;/p&gt;

&lt;p&gt;Let’s finish you up by making some changes to the somewhat simplistic login form provided by slice-password. Because we’re dealing with a slice here, we can easily provide new templates for the slice. Check out the directory structure of your project - since you installed that slice, you’ve got a slices folder in the root. Within it, a folder for each of your slices, gloriously arranged for your inspection. Each folder empty, awaiting your instructions. With any slice, you can override views on a per-file basis. Unfortunately due to &lt;a href="http://merb.lighthouseapp.com/projects/7433-merb/tickets/1024-merb-auth-slice-password-and-overrides-problem#ticket-1024-2"&gt;this bug&lt;/a&gt; in Merb 1.0, we have to go about this in a slightly askew fashion for slice-password. In terminal:&lt;/p&gt;

&lt;pre&gt;&lt;code class="bash"&gt;rake slices:merb-auth-slice-password:freeze&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;This will copy the slice files into your slices folder for you to tweak. I’m also going to force the slice files to render inside my main application’s layout:&lt;/p&gt;

&lt;pre&gt;&lt;code class="ruby"&gt;#in config/init.rb
Merb::Slices::config[:merb_auth_slice_password][:layout] = :application&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;I’ll restart the slice to see what happened:&lt;/p&gt;

&lt;p&gt;&lt;img alt="Just awesome" src="http://img.skitch.com/20081122-cxn9jf913799586p93rtm6wpgr.jpg"/&gt;&lt;/p&gt;

&lt;p&gt;Awesome.&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>How to get Quicksilver's radial menus to play nice with your mouse</title>
   <link href="http://www.angryamoeba.co.uk/singlecell/2008/11/17/How-to-get-Quicksilver-s-radial-menus-to-play-nice-with-your-mouse.html"/>
   <updated>2008-11-17T00:00:00+00:00</updated>
   <id>http://www.angryamoeba.co.uk/singlecell/2008/11/17/How-to-get-Quicksilver-s-radial-menus-to-play-nice-with-your-mouse</id>
   <content type="html"> 

&lt;p&gt;You may have seen &lt;a href="http://blacktree.com/?quicksilver"&gt;Quicksilver&lt;/a&gt;’s &lt;a href="http://www.usingmac.com/2007/10/15/radial-quicksilver-menu"&gt;Radial Constellation menus&lt;/a&gt;, which are freaking awesome. Behold:&lt;/p&gt;

&lt;p&gt;&lt;img src="http://img.skitch.com/20081117-1teepr16we8n9q9j7cry3r55j1.jpg" alt="Awesome radial menus" title="" style="border: 10px solid #EEE; margin: 0 10px; display: block;"/&gt;&lt;/p&gt;

&lt;p&gt;Wouldn’t it be great if you could get them to pop up when you click on items with a particular mouse button or modifier key? Hell yeah it would. And as it turns out, Quicksilver already contains all the science you need to do it. To get started:&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;Open Quicksilver’s preference pane and tick ‘&lt;strong&gt;Enable advanced features&lt;/strong&gt;.’ Allow Quicksilver to shout at you for a moment. Agree when it asks to restart itself.&lt;/li&gt;
&lt;li&gt;Re-open the preference pane and click ‘&lt;strong&gt;Plug-ins&lt;/strong&gt;’ in the toolbar. Search for three addons: &lt;strong&gt;Constallation Menus&lt;/strong&gt;, &lt;strong&gt;Mouse Triggers&lt;/strong&gt; and &lt;strong&gt;User Interface Access&lt;/strong&gt;. Install them.&lt;/li&gt;
&lt;li&gt;Click the ‘&lt;strong&gt;Catalog&lt;/strong&gt;’ toolbar item and select ‘&lt;strong&gt;Quicksilver&lt;/strong&gt;’ from the source list on the left. Tick ‘&lt;strong&gt;Proxy Objects&lt;/strong&gt;’ on the right if it isn’t already ticked. Restart Quicksilver again.&lt;/li&gt;
&lt;li&gt;Open the preference pane for the third and final time and select ‘&lt;strong&gt;Triggers&lt;/strong&gt;’. Click the &lt;strong&gt;+&lt;/strong&gt; sign at the bottom of the window and select ‘&lt;strong&gt;Mouse&lt;/strong&gt;’.&lt;/li&gt;
&lt;li&gt;Double-click the item and make a selection like this: &lt;br/&gt;&lt;br/&gt;&lt;img src="http://img.skitch.com/20081117-mm9nsafnnb9ef74a8fnyim5prt.jpg" alt="Current selection" title="" style="border: 10px solid #EEE; margin: 0 10px; display: block;"/&gt;&lt;br/&gt;
&lt;/li&gt;
&lt;li&gt;Pick which mouse button and modifiers you want to trigger the menu: &lt;br/&gt;&lt;br/&gt;&lt;img src="http://img.skitch.com/20081117-rp6r4gqdfes3qncf98us7mifju.jpg" alt="Trigger panel" title="" style="border: 10px solid #EEE; margin: 0 10px; display: block;"/&gt;&lt;br/&gt;
&lt;/li&gt;
&lt;li&gt;Enjoy.&lt;/li&gt;
&lt;/ol&gt;
</content>
 </entry>
 
 <entry>
   <title>In which we enjoy catharsis by joining the Merb vs. Rails drama</title>
   <link href="http://www.angryamoeba.co.uk/singlecell/2008/11/16/In-which-we-enjoy-catharsis-by-joining-the-Merb-vs-Rails-drama.html"/>
   <updated>2008-11-16T00:00:00+00:00</updated>
   <id>http://www.angryamoeba.co.uk/singlecell/2008/11/16/In-which-we-enjoy-catharsis-by-joining-the-Merb-vs-Rails-drama</id>
   <content type="html"> 

&lt;p&gt;Summarising this post from &lt;a href="http://merbist.com/2008/11/15/rails-vs-merb-drama/"&gt;Merbist&lt;/a&gt;, in which the current bun fight between Rails and Merb camps is documented in detail:&lt;/p&gt;

&lt;p&gt;&lt;a href="http://www.rubyonrails.com/"&gt;Rails&lt;/a&gt; is enormous and comes as a package. Although it is theoretically possible to run Rails without some of the bajillion modules it loads at boot, it involves freezing your Rails version, removing a bunch of includes, staying clear of any dependent methods and, oh yeah, never being able to easily upgrade to newer Rails versions again. Ever. &lt;/p&gt;

&lt;p&gt;&lt;a href="http://merbivore.com/"&gt;Merb&lt;/a&gt; is smaller, although younger (Rails used to be smallish too), but it has a modular design which allows you to actively decide the size of the included framework. Smaller projects can use only the core controller stack, while larger projects can introduce Merb&amp;#8217;s ORM, view and many helper modules on a selective basis as they are needed. Merb is also faster in most cases (YMMV) and in my own personal experience has a far lower rate of &lt;a href="http://www.osnews.com/story/19266/WTFs_m"&gt;WTFs/minute&lt;/a&gt;  when reading through both core source and addon source, thanks to Merb&amp;#8217;s plugin API.&lt;/p&gt;

&lt;p&gt;Merb has taken functional cues from Rails&amp;#8217; brilliant RESTful resource handling and multi-format controller actions, and Rails is taking some architectural cues from Merb&amp;#8217;s super-fast controller stack and non-blocking file uploads. &lt;/p&gt;

&lt;p&gt;I have problems with Rails&amp;#8217; lack of modular containment and high-maintenance hackability, but I also see why there&amp;#8217;s room for an end-to-end framework in the marketplace. I have problems with &lt;a href="http://loudthinking.com/"&gt;DHH&lt;/a&gt;&amp;#8217;s &lt;a href="http://blog.wekeroad.com/2007/10/10/imploding-rails-jesus-dhh-and-the-uncle-ben-principle/"&gt;decision to solicit help from a community he had no intention of listening to&lt;/a&gt;, but I also appreciate that strength of ideology is what made Rails take off in the first place. &lt;/p&gt;

&lt;p&gt;I just wish Rails didn&amp;#8217;t so finely straddle the line between being &amp;#8220;opinionated&amp;#8221; and being an &lt;a href="http://www.flickr.com/photos/doesrails/128015501/"&gt;irresponsible douche&lt;/a&gt;. &lt;/p&gt;

&lt;p&gt;In the end, we&amp;#8217;re all trying to solve the same problems. So find the tools you like, help them grow, and have fun hacking. And for science&amp;#8217;s sake, don&amp;#8217;t be a douche.&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Create with Context on How people really use the iPhone</title>
   <link href="http://www.angryamoeba.co.uk/singlecell/2008/11/13/Create-with-Context-on-How-people-really-use-the-iPhone.html"/>
   <updated>2008-11-13T00:00:00+00:00</updated>
   <id>http://www.angryamoeba.co.uk/singlecell/2008/11/13/Create-with-Context-on-How-people-really-use-the-iPhone</id>
   <content type="html"> 

&lt;p&gt;The guys and girls over at &lt;a href="http://www.createwithcontext.com/"&gt;Create with Context&lt;/a&gt; have created a very interesting document detailing the results of their independent user testing of the iPhone, and in a stroke of sheer brilliance they&amp;#8217;ve &lt;a href="http://www.createwithcontext.com/how-people-really-use-the-iphone.html"&gt;made it available to all of us&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Their look into usability of the in-built iPhone apps turns up some interesting points about Apple&amp;#8217;s iconography. Many users note confusion around the purpose of some icons, most notably between search and zoom. It seems that some users expect magnifying glass icons to either increase the current zoom level, or to reset the zoom level to a full-page view. This is unfortunate, because the magnifying glass is, on the desktop, the canonical icon for search - so I&amp;#8217;m curious to see if these results are specific to user interfaces that are so centered around zoom and pan, or if we&amp;#8217;ve been missing problems with desktop iconography all along. It&amp;#8217;s also possible that the relatively cramped conditions on the iPhone&amp;#8217;s screen give little opportunity to space controls out and give them distinct context.&lt;/p&gt;

&lt;p&gt;Most useful for my fellow Cocoa Touch developers is the section on App Store experiences, which gives insight into app pricing, which App Store listings and the impact of positive/negative reviews on the download page.&lt;/p&gt;

&lt;p&gt;It&amp;#8217;s a &lt;a href="http://www.createwithcontext.com/how-people-really-use-the-iphone.html"&gt;highly recommended download&lt;/a&gt; and I&amp;#8217;d like to thank Create with Context for making it available to all of us.&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Barclays online banking uses sketchy external stats provider, is only as secure as a sketchy external stats provider.</title>
   <link href="http://www.angryamoeba.co.uk/singlecell/2008/08/28/Barclays-online-banking-uses-sketchy-external-stats-provider-is-only-as-secure-as-a-sketchy-external-stats-provider.html"/>
   <updated>2008-08-28T00:00:00+01:00</updated>
   <id>http://www.angryamoeba.co.uk/singlecell/2008/08/28/Barclays-online-banking-uses-sketchy-external-stats-provider-is-only-as-secure-as-a-sketchy-external-stats-provider</id>
   <content type="html"> 

&lt;p&gt;Basic software security, lesson #1: You are only as secure as the weakest point in your system.&lt;/p&gt;

&lt;p&gt;It&amp;#8217;s a valuable lesson. Earlier this year Barclays made a big show of security, even going so far as to &lt;a href="http://www.barclays.co.uk/pinsentry/"&gt;mail two-factor authentication devices to their customers&lt;/a&gt; in an attempt to prevent online banking fraud. That&amp;#8217;s a big investment.&lt;/p&gt;

&lt;p&gt;Unfortunately for Barclays, it doesn&amp;#8217;t matter, and their money was wasted. Because if you want to compromise the computers of Barclays account holders, there&amp;#8217;s no need to circumvent the giant, thoroughly-audited security schemes that are almost certainly in place. Nope, you just need to compromise their analytics provider.&lt;/p&gt;

&lt;img src="http://img.skitch.com/20080828-txecf7ttm1myj9qf2qbssx2kum.jpg" alt="code fail"/&gt;&lt;p&gt;That&amp;#8217;s right, every page load from your &amp;#8220;private&amp;#8221;, &amp;#8220;secure&amp;#8221; banking pages is also communicating directly with Webtrends&amp;#8217; servers. And worse, Webtrends get to run code within the page, putting you totally at their mercy. If an angry Webtrends employee wants to harvest your banking data, he needs only change that javascript without alerting Barclays first. If you google &amp;#8220;&lt;a href="http://www.google.co.uk/search?q=webtrendslive"&gt;webtrendslive&lt;/a&gt;&amp;#8221;, by the way, you&amp;#8217;ll notice that malware reports actually outrank the actual product site. It&amp;#8217;s a nice touch.&lt;/p&gt;

&lt;p&gt;Anyway. Looks fine, right? They&amp;#8217;re just including a local script from the /f directory. No. The script they&amp;#8217;re pulling from a local file is in fact writing a new script tag to the document, which will load a script from an external server. Take a look:&lt;/p&gt;

&lt;pre class="javascript"&gt;&lt;code&gt;// THIS IS ALL INNOCENT ENOUGH
var gDomain="statse.webtrendslive.com";
var gDcsId="REDACTED";
var gFpc="WT_FPC";
var gConvert=true;
var gFpcDom=".barclays.co.uk";

// WELL, IT'S ONLY BANKING INNIT. THE SECURITY MODEL ONLY
// PREVENTS YOU FROM DOING THIS SO YOU DON'T LOSE YOUR
// MYSPACE PASSWORD.

if ((typeof(gConvert)!="undefined")&amp;amp;&amp;amp;gConvert&amp;amp;&amp;amp;(document.cookie.indexOf(gFpc+"=")==-1)&amp;amp;&amp;amp;(document.cookie.indexOf("WTLOPTOUT=")==-1)){
 document.write("&amp;lt;SCR"+"IPT TYPE='text/javascript' SRC='"+"http"+(window.location.protocol.indexOf('https:')==0?'s':'')+"://"+gDomain+"/"+gDcsId+"/wtid.js"+"'&amp;gt;&amp;lt;\/SCR"+"IPT&amp;gt;");
}&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Why does it have to do this, you ask? Because the browser security model &lt;strong&gt;specifically prevents you&lt;/strong&gt; from making off-site requests in this way to protect the user from, oh, script injection vulnerabilities and having their details pinched by dastardly or inept external script providers. But this is only banking, right? S&amp;#8217;probably fine to just ignore the reasons not to do it and go ahead with it. It&amp;#8217;s not like you can assess your stats by analyzing your own logs or anything.&lt;/p&gt;

&lt;p&gt;Basic software security, lesson #1: You are only as secure as the weakest point in your system.&lt;/p&gt;

&lt;p&gt;It&amp;#8217;s a valuable lesson.&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Testing for desirable errors in Ruby</title>
   <link href="http://www.angryamoeba.co.uk/singlecell/2008/07/04/Testing-for-desirable-errors-in-Ruby.html"/>
   <updated>2008-07-04T00:00:00+01:00</updated>
   <id>http://www.angryamoeba.co.uk/singlecell/2008/07/04/Testing-for-desirable-errors-in-Ruby</id>
   <content type="html"> 

Sometimes, you &lt;em&gt;want&lt;/em&gt; your code to fail. You want to make sure that in the event of a failure, an exception is generated - the equivalent of a controlled explosion. Something you can design contingencies around. Until now I&amp;#8217;ve been a little frustrated with testing these eventualities, so I decided to hack up a quick custom assertion for your Test::Unit suites (although it should translate pretty effortlessly to RSpec or any other test framework):

&lt;pre class="ruby"&gt;&lt;code&gt;
# In test_helper.rb:
def assert_error_raised(errorklass=StandardError, &amp;amp;block)
     raised = false
     begin
       block.call 
     rescue errorklass 
       raised = true
     end
     # You will see this message if an error was not raised.
     # If an error was raised which was not of the type you specified, then the test trace
     # will be allowed to display the error as normal and the test will fail with an E.
     assert raised, "Expected error #{errorklass.to_s} to be raised but error never encountered."
end

# In your application code, let's say some_model.rb:
def do_something_with(array)
       unless array.is_a?(Array)
              raise ArgumentError, "Argument of type #{array.class.to_s} given to SomeModel#do_something when argument must be of type Array"
       end
       continue_doing_something
end

# In your test suite:
def test_error_generated_with_bad_argument_to_do_something_with
       @some_model = SomeModel.new
       # This test will pass
       assert_error_raised(ArgumentError) do
              @some_model.do_something_with "i'm not an array"
       end
       # This test will fail and dump the error via your test console's usual channel
       assert_error_raised(RuntimeError) do
              @some_model.do_something_with "neither am i"
       end
end&lt;/code&gt;&lt;/pre&gt;
</content>
 </entry>
 
 <entry>
   <title>Chirrup 0.81 released</title>
   <link href="http://www.angryamoeba.co.uk/singlecell/2008/07/03/Chirrup-0-81-released.html"/>
   <updated>2008-07-03T00:00:00+01:00</updated>
   <id>http://www.angryamoeba.co.uk/singlecell/2008/07/03/Chirrup-0-81-released</id>
   <content type="html"> 

&lt;p&gt;Hi there, sorry I haven&amp;#8217;t written in a while. It&amp;#8217;s this damned work business. Some actual content is promised soon.&lt;/p&gt;

&lt;p&gt;Anyhow - A rather nasty text-escaping bug popped up in Chirrup, so I&amp;#8217;ve issued a patch in version 0.81 which is &lt;a href="http://chirrup.angryamoeba.co.uk"&gt;available for download&lt;/a&gt; now.&lt;/p&gt;

&lt;p&gt;The problem: Badly-formatted tweets containing certain special characters caused Chirrup&amp;#8217;s JSON to fail parsing and the Chirrup UI to not display.&lt;/p&gt;

&lt;p&gt;The fix: Improved sanitisation routine for tweet data being sent over JSON.&lt;/p&gt;

&lt;p&gt;Happy Tweeting.&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>How to force Git to ignore files</title>
   <link href="http://www.angryamoeba.co.uk/singlecell/2008/05/24/How-to-force-Git-to-ignore-files.html"/>
   <updated>2008-05-24T00:00:00+01:00</updated>
   <id>http://www.angryamoeba.co.uk/singlecell/2008/05/24/How-to-force-Git-to-ignore-files</id>
   <content type="html"> 

Just documenting this one for later, really. If you&amp;#8217;re setting up a git repository and you need to ignore certain types of file - logs, or python bytecode (not that I&amp;#8217;m dealing with those two problems at this exact moment or anything), the procedure is quite simple:

&lt;pre&gt;&lt;code&gt;
# Get to the hidden .git directory within your project.
cd /path/to/your/project
cd .git/info
# in .git/info is a file named "exclude". Open it in whatever you like. Here we'll open it with Textmate.
mate exclude
&lt;/code&gt;&lt;/pre&gt;

The file&amp;#8217;s contents are, by default, commented out. To add your own ignore rules, just add each rule on a new line. Here&amp;#8217;s a simple example from a Python project which prevents bytecode and Textmate project files from being committed:

&lt;pre&gt;&lt;code&gt;
*.pyc
*.tmproj
&lt;/code&gt;&lt;/pre&gt;

In a Rails project, you&amp;#8217;d likely want a set of rules like the following &lt;em&gt;completely untested&lt;/em&gt; fragment:

&lt;pre&gt;&lt;code&gt;
log
*.log
*.pid
tmp
&lt;/code&gt;&lt;/pre&gt;
</content>
 </entry>
 
 <entry>
   <title>Chirrup launched for public use</title>
   <link href="http://www.angryamoeba.co.uk/singlecell/2008/05/20/Chirrup-launched-for-public-use.html"/>
   <updated>2008-05-20T00:00:00+01:00</updated>
   <id>http://www.angryamoeba.co.uk/singlecell/2008/05/20/Chirrup-launched-for-public-use</id>
   <content type="html"> 

&lt;p&gt;Well, that&amp;#8217;s another silly little side-project in the can. If you&amp;#8217;d like to have Twitter comments on your blog, wiki, website, or basically anything with a URL, head on over to &lt;a href="http://chirrup.angryamoeba.co.uk"&gt;chirrup.angryamoeba.co.uk&lt;/a&gt; and download Chirrup to get started!&lt;/p&gt;

&lt;p&gt;Thanks to the &lt;a href="http://www.videojuicer.com"&gt;Videojuicer&lt;/a&gt; dev team for helping with testing - &lt;a href="http://skein.tumblr.com/"&gt;Ted Han&lt;/a&gt;, &lt;a href="http://sd2.com/"&gt;John Carlin&lt;/a&gt;, &lt;a href="http://aelius.net/"&gt;Alex Nichol&lt;/a&gt; and &lt;a href="http://mochapowered.com/"&gt;Adam Livesley&lt;/a&gt;. And thanks to Adam for turning Chirrup into a &lt;a href="http://chirrup.angryamoeba.co.uk/docs/wordpress.html"&gt;wordpress plugin&lt;/a&gt; - this functionality is included in the main &lt;a href="http://chirrup.angryamoeba.co.uk/download.html"&gt;download package &lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Thanks for bearing with us over the testing period, and have fun with Chirrup!&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Chirrup - Twitter comments for your blog!</title>
   <link href="http://www.angryamoeba.co.uk/singlecell/2008/05/13/Chirrup-Twitter-comments-for-your-blog.html"/>
   <updated>2008-05-13T00:00:00+01:00</updated>
   <id>http://www.angryamoeba.co.uk/singlecell/2008/05/13/Chirrup-Twitter-comments-for-your-blog</id>
   <content type="html"> 

&lt;p&gt;UPDATE: Chirrup is now available to the public. Visit &lt;a href="http://chirrup.angryamoeba.co.uk"&gt;chirrup.angryamoeba.co.uk&lt;/a&gt; to get your copy.&lt;/p&gt;

&lt;p&gt;You might&amp;#8217;ve noticed some new features here at Singlecell - we&amp;#8217;ve been working on a library called Chirrup, which allows you to include comments from Twitter in your pages.&lt;/p&gt;

&lt;p&gt;The idea behind Chirrup is to provide a more natural relationship between dialogue happening on individual pages and dialogue happening in public on applications such as Twitter. People are discussing content in comment sections, and then duplicating the discussion on Twitter - so why not marry the two up?&lt;/p&gt;

&lt;p&gt;When you post a comment to a page via Chirrup, your comment is sent as an @reply to the blog&amp;#8217;s owner, and contains both the URL and your comment. This means that your comments are completely legible to the rest of Twitter, and contain no unnecessary data.&lt;/p&gt;

&lt;p&gt;Chirrup&amp;#8217;s server-side component then slurps up the blog owner&amp;#8217;s @replies and sorts through them for Chirrup responses. It supports compression and decompression of tinyurl&amp;#8217;s, so comments sent with all major Twitter clients can be recognised by Chirrup&amp;#8217;s parser.&lt;/p&gt;

&lt;p&gt;Chirrup will enjoy a short testing period on this page while I snarf down huge piles of my own dog food, and will then be released under a &lt;a href="http://creativecommons.org"&gt;Creative Commons&lt;/a&gt; license.&lt;/p&gt;

&lt;p&gt;In the meantime, if you find a bug in Chirrup&amp;#8217;s behaviour, I&amp;#8217;d be obliged if you&amp;#8217;d post it to the &lt;a href="http://www.bugtails.com/projects/156/"&gt;Chirrup bugtracker&lt;/a&gt; on &lt;a href="http://tailshq.com"&gt;Tails&lt;/a&gt;.&lt;/p&gt;
</content>
 </entry>
 
 
</feed>