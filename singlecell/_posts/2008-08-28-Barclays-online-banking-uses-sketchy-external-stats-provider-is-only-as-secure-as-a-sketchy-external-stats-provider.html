<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML+RDFa 1.0//EN" "http://www.w3.org/MarkUp/DTD/xhtml-rdfa-1.dtd">

	
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
	<head>
		<meta http-equiv="Content-type" content="text/html; charset=utf-8" />
		<meta http-equiv="Content-Language" content="en-us" />
		
		<title>Barclays online banking uses sketchy external stats provider, is only as secure as a sketchy external stats provider.</title>
		
		<meta name="ROBOTS" content="ALL" />
		<meta http-equiv="imagetoolbar" content="no" />
		<meta name="MSSmartTagsPreventParsing" content="true" />
		<meta name="Copyright" content="(c) 2005 Copyright content: Angry amoeba Copyright design: Angry amoeba" />
		<!-- (c) Copyright 2005 by Angryamoeba All Rights Reserved. -->
		
		<meta name="Keywords" content="angryamoeba, amoeba, dan, glegg, danski, daniel, applications, CSS, XHTML, javascript,
												 PHP, HTML, MySQL, SQL, ruby, rails, actionscript, action, script, flash, OOP, 
												 development, developer, uk, sussex, england, great, britain, programmer, programming,
												 blogger, podcast, blog, useful, software, W3C, standards, bish, bash, bosh" />
		<meta name="Description" content="A blog about technology, business, products, web standards and the open web." />
		

		<!-- Presentation -->
		<link rel="stylesheet" href="/stylesheets/angryamoeba-core.css" type="text/css" media="all" charset="utf-8" />
		<link rel="stylesheet" href="/stylesheets/angryamoeba-blog.css" type="text/css" media="all" charset="utf-8" />
		<link rel="stylesheet" href="/stylesheets/angryamoeba-docs.css" type="text/css" media="all" charset="utf-8" />
		
		<!-- Interactivity -->
		<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.0/jquery.min.js"></script>
		<script type="text/javascript" src="/lib/angryamoeba/angryamoeba-core.js"></script>
		<script type="text/javascript" src="/lib/angryamoeba/angryamoeba-blog.js"></script>
</head>
	
	<body>		
			<div id="network" class="section">
		<ol class="sub navigation">
			<li><h1><a href="/" class="home"><img src="/images/brand/amoeba-text-small.png" alt="Dan Glegg, Angry amoeba" /></a></h1></li>
			<li><a href="/singlecell/" class="blog">Singlecell Blog</a></li>
			<li><a href="/startup.html" class="consulting">Services for Startups</a></li>
			<li><a href="/about.html" class="about">About</a></li>
		</ol>
</div>			

			
<div id="focus" class="section forty-sixty">

			<h2 class="left">
				<a href="/singlecell">Barclays online banking uses sketchy external stats provider, is only as secure as a sketchy external stats provider.</a>
				<span class="date"></span>
			</h2>
			
			<div class="right box">
				 

<p>Basic software security, lesson #1: You are only as secure as the weakest point in your system.</p>

<p>It&#8217;s a valuable lesson. Earlier this year Barclays made a big show of security, even going so far as to <a href="http://www.barclays.co.uk/pinsentry/">mail two-factor authentication devices to their customers</a> in an attempt to prevent online banking fraud. That&#8217;s a big investment.</p>

<p>Unfortunately for Barclays, it doesn&#8217;t matter, and their money was wasted. Because if you want to compromise the computers of Barclays account holders, there&#8217;s no need to circumvent the giant, thoroughly-audited security schemes that are almost certainly in place. Nope, you just need to compromise their analytics provider.</p>

<img src="http://img.skitch.com/20080828-txecf7ttm1myj9qf2qbssx2kum.jpg" alt="code fail"/><p>That&#8217;s right, every page load from your &#8220;private&#8221;, &#8220;secure&#8221; banking pages is also communicating directly with Webtrends&#8217; servers. And worse, Webtrends get to run code within the page, putting you totally at their mercy. If an angry Webtrends employee wants to harvest your banking data, he needs only change that javascript without alerting Barclays first. If you google &#8220;<a href="http://www.google.co.uk/search?q=webtrendslive">webtrendslive</a>&#8221;, by the way, you&#8217;ll notice that malware reports actually outrank the actual product site. It&#8217;s a nice touch.</p>

<hr />

<p>Anyway. Looks fine, right? They&#8217;re just including a local script from the /f directory. No. The script they&#8217;re pulling from a local file is in fact writing a new script tag to the document, which will load a script from an external server. Take a look:</p>

<pre class="javascript"><code>// THIS IS ALL INNOCENT ENOUGH
var gDomain="statse.webtrendslive.com";
var gDcsId="REDACTED";
var gFpc="WT_FPC";
var gConvert=true;
var gFpcDom=".barclays.co.uk";

// WELL, IT'S ONLY BANKING INNIT. THE SECURITY MODEL ONLY
// PREVENTS YOU FROM DOING THIS SO YOU DON'T LOSE YOUR
// MYSPACE PASSWORD.

if ((typeof(gConvert)!="undefined")&amp;&amp;gConvert&amp;&amp;(document.cookie.indexOf(gFpc+"=")==-1)&amp;&amp;(document.cookie.indexOf("WTLOPTOUT=")==-1)){
 document.write("&lt;SCR"+"IPT TYPE='text/javascript' SRC='"+"http"+(window.location.protocol.indexOf('https:')==0?'s':'')+"://"+gDomain+"/"+gDcsId+"/wtid.js"+"'&gt;&lt;\/SCR"+"IPT&gt;");
}</code></pre>

<p>Why does it have to do this, you ask? Because the browser security model <strong>specifically prevents you</strong> from making off-site requests in this way to protect the user from, oh, script injection vulnerabilities and having their details pinched by dastardly or inept external script providers. But this is only banking, right? S&#8217;probably fine to just ignore the reasons not to do it and go ahead with it. It&#8217;s not like you can assess your stats by analyzing your own logs or anything.</p>

<p>Basic software security, lesson #1: You are only as secure as the weakest point in your system.</p>

<p>It&#8217;s a valuable lesson.</p>

				<!-- vCard and bio -->
<div id="hcard-Dan-Glegg" class="vcard">
	 <img src="/images/icons/dan-portrait-small.jpg" alt="Photo of Dan speaking at an event" title="Image thanks to Richard Dallaway" class="photo"/>
	<p>
		<a class="url fn" href="http://www.angryamoeba.co.uk/singlecell/">Dan Glegg</a> is a software developer living and working in 
		<span class="adr"><span class="locality">Brighton</span>, <span class="country-name">United Kingdom</span></span>. 
		He works mainly with Ruby, Objective-C, Flex and W3C standards and spends most of his time 
		<a class="url" href="/startup.html">working with startup companies</a>.
	</p>
	
	<ul>
		<li><a href="http://twitter.com/angryamoeba" class="url social twitter">Twitter</a></li>
		<li><a href="http://www.linkedin.com/in/angryamoeba" class="url social linkedin">LinkedIn</a></li>
		<li><a href="http://flickr.com/photos/angryamoeba/" class="url social flickr">Flickr</a></li>
		<li><a href="http://github.com/danski/" class="url social github">Github</a></li>
		<li><a href="http://delicious.com/danski" class="url social delicious">Del.icio.us</a></li>
	</ul>								

	<div class="tags">
		<a href="http://kitchen.technorati.com/contacts/tag/startup">startup</a> 
		<a href="http://kitchen.technorati.com/contacts/tag/entrepreneur">entrepreneur</a> 
		<a href="http://kitchen.technorati.com/contacts/tag/developer">developer</a> 
		<a href="http://kitchen.technorati.com/contacts/tag/engineer">engineer</a> 
		<a href="http://kitchen.technorati.com/contacts/tag/technology">technology</a> 
		<a href="http://kitchen.technorati.com/contacts/tag/consultancy">consultancy</a> 
		<a href="http://kitchen.technorati.com/contacts/tag/ruby">ruby</a> 
		<a href="http://kitchen.technorati.com/contacts/tag/flex">flex</a> 
		<a href="http://kitchen.technorati.com/contacts/tag/objective-c">objective-c</a> 
		<a href="http://kitchen.technorati.com/contacts/tag/iphone">iphone</a> 
		<a href="http://kitchen.technorati.com/contacts/tag/mac">mac</a> 
		<a href="http://kitchen.technorati.com/contacts/tag/w3c">w3c</a>
	</div>
</div>
			</div>
	
</div>

<div id="content" class="section forty-sixty">
	

	<div class="right box bright">
		<div id="disqus_thread"></div>
		<a href="http://disqus.com" class="dsq-brlink">Blog comments powered by <span class="logo-disqus">Disqus</span></a>		
	</div>

	
</div>			
			
			<div id="footer" class="section fifty-fifty">
	<span class="left copyright">
		Design and brand copyright &copy; <a href="/">Dan Glegg</a> 2009. 
		
		The <a href="http://www.videojuicer.com" rel="external">Videojuicer</a> and <a href="http://oauth.net/" rel="external">OAuth</a> marks
		are property of their respective owners.
		
		
		<span xmlns:dc="http://purl.org/dc/elements/1.1/" href="http://purl.org/dc/dcmitype/Text" property="dc:title" rel="dc:type">
				The text content of all posts from Singlecell, the Angry amoeba weblog
		</span> by 
		<a xmlns:cc="http://creativecommons.org/ns#" href="http://www.angryamoeba.co.uk" property="cc:attributionName" rel="cc:attributionURL">Dan Glegg</a> 
				is licensed under a 
		<a rel="license" href="http://creativecommons.org/licenses/by-nd/3.0/us/">Creative Commons Attribution-No Derivative Works 3.0 United States License</a>.
		<a rel="license" href="http://creativecommons.org/licenses/by-nd/3.0/us/">
			<img alt="Creative Commons License" src="http://i.creativecommons.org/l/by-nd/3.0/us/80x15.png" />
		</a>
	</span>
	<ol class="navigation right">
		<li><a href="/" class="home">Home</a></li>
		<li><a href="/singlecell/" class="blog" rel="external">Singlecell Blog</a></li>
		<li><a href="/startup.html" class="consulting">Services for Startups</a></li>
		<li><a href="/about.html" class="about">About</a></li>
		<li><a href="http://validator.w3.org/check?uri=referer" rel="external">Validate HTML</a></li>
	</ol>				
</div>
			<script type="text/javascript">
	var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
	document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
	var pageTracker = _gat._getTracker("UA-1036922-2"); pageTracker._initData(); pageTracker._trackPageview();
</script>
	</body>
	
</html>
